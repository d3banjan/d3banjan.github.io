---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import SeriesCard from '../components/SeriesCard.astro';
import { getPublishedPosts, SERIES_META, SITE_DESCRIPTION, SITE_TITLE } from '../consts';

const posts = await getPublishedPosts();

const seriesGroups = new Map<string, typeof posts>();
const standalonePosts: typeof posts = [];

for (const post of posts) {
	if (post.data.series && SERIES_META[post.data.series]) {
		const group = seriesGroups.get(post.data.series) ?? [];
		group.push(post);
		seriesGroups.set(post.data.series, group);
	} else {
		standalonePosts.push(post);
	}
}

standalonePosts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
		<style>
			main {
				width: 960px;
				max-width: calc(100% - 2em);
				margin: auto;
				padding: 3em 1em;
			}
			.tagline {
				font-style: italic;
				color: var(--accent);
				font-size: 1.1em;
				margin-bottom: 0.5em;
			}
			.location {
				color: rgb(var(--gray));
				margin-bottom: 2em;
			}
			section {
				margin-bottom: 2.5em;
			}
			h2 {
				border-bottom: 2px solid var(--accent);
				padding-bottom: 0.3em;
				margin-bottom: 1em;
			}
			.topics {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
				gap: 1em;
				margin-top: 1em;
			}
			.topic {
				padding: 1em;
				background: rgba(var(--gray-light), 0.1);
				border-radius: 4px;
			}
			.topic h3 {
				margin: 0 0 0.5em 0;
				color: var(--accent);
				font-size: 1em;
			}
			.topic p {
				margin: 0;
				font-size: 0.95em;
				color: rgb(var(--gray));
			}
			.topic h3 a {
				color: var(--accent);
				text-decoration: none;
			}
			.topic h3 a:hover {
				text-decoration: underline;
			}
			.topic p a {
				color: var(--accent);
			}
			.cta {
				margin-top: 2em;
			}
			.cta a {
				display: inline-block;
				background: var(--accent);
				color: white;
				padding: 0.6em 1.5em;
				border-radius: 4px;
				text-decoration: none;
				margin-right: 1em;
				margin-bottom: 0.5em;
			}
			.cta a:hover {
				opacity: 0.9;
			}
			.cta a.secondary {
				background: transparent;
				border: 1px solid var(--accent);
				color: var(--accent);
			}
			.contact-reveal {
				color: var(--accent);
				cursor: pointer;
				text-decoration: underline;
				background: none;
				border: none;
				font: inherit;
				padding: 0;
			}
			.contact-info {
				margin-top: 1em;
				padding: 1em;
				background: rgba(var(--gray-light), 0.1);
				border-radius: 4px;
				display: none;
			}
			.contact-info.visible {
				display: block;
			}
		</style>
	</head>
	<body>
		<Header />
		<main>
			<h1>Debanjan Basu</h1>
			<p class="tagline">Where theoretical physics meets practical AI</p>

			<p class="location">Berlin, Germany</p>

			<section>
				<p>
					I'm a Senior Python Developer working at the intersection of AI systems,
					distributed computing, and backend infrastructure. My path here wasn't linear—it wound
					through five years of theoretical physics research at TU Clausthal, data science at an
					IoT startup, and eventually into building production AI systems.
				</p>
				<p>
					What I carry from physics isn't just mathematical fluency. It's a particular way of seeing:
					finding the minimal description that captures a system's essential behavior, recognizing
					when a problem has hidden symmetries, knowing when to zoom in on details and when to step
					back and look for universal patterns.
				</p>
				<p>
					These days, I build AI agent systems, web scraping infrastructure, and observability pipelines.
					I'm fascinated by the emerging discipline of making AI systems that are
					not just capable, but <em>observable</em>, <em>debuggable</em>, and <em>composable</em>.
				</p>
			</section>

			<section>
				<h2>Series</h2>
				<div class="topics">
					{
						Object.keys(SERIES_META).map((name) => {
							const group = seriesGroups.get(name) ?? [];
							return group.length > 0 ? (
								<SeriesCard seriesName={name} posts={group} />
							) : null;
						})
					}
				</div>
			</section>

			{
				standalonePosts.length > 0 && (
					<section>
						<h2>Standalone Posts</h2>
						<div class="topics">
							{standalonePosts.map((post) => (
								<div class="topic">
									<h3>
										<a href={`/blog/${post.id}/`}>{post.data.title}</a>
									</h3>
									<p>{post.data.description}</p>
								</div>
							))}
						</div>
					</section>
				)
			}

			<section>
				<h2>What I Write About</h2>
				<div class="topics">
					<div class="topic">
						<h3>The Practical Side</h3>
						<p>
							Development environment deep-dives, agent harness architectures,
							LLM orchestration patterns, and observability for AI systems.
						</p>
					</div>
					<div class="topic">
						<h3>The Theoretical Side</h3>
						<p>
							Physics-inspired approaches to understanding neural networks—phase transitions,
							renormalization group theory, information geometry.
						</p>
					</div>
					<div class="topic">
						<h3>Other Wanderings</h3>
						<p>
							Ancient history, travels to places where the past feels tangible,
							and whatever else I find worth thinking through in writing.
						</p>
					</div>
				</div>
			</section>

			<section>
				<h2>Get in Touch</h2>
				<p>
					I'm always interested in conversations about AI systems, physics-informed machine learning,
					or elegant solutions to hard problems.
				</p>
				<button class="contact-reveal" id="reveal-contact">Click to reveal contact details</button>
				<div class="contact-info" id="contact-info">
					<noscript>Email: debanjan.basu.ds [at] gmail [dot] com</noscript>
				</div>
			</section>

			<div class="cta">
				<a href="/blog/">Read the Blog</a>
				<a href="/about/" class="secondary">View CV</a>
			</div>
		</main>
		<Footer />

		<script>
			// Obfuscated email - decoded only on user interaction
			const e = [100,101,98,97,110,106,97,110,46,98,97,115,117,46,100,115,64,103,109,97,105,108,46,99,111,109];

			document.getElementById('reveal-contact')?.addEventListener('click', function() {
				const email = String.fromCharCode(...e);
				const container = document.getElementById('contact-info');
				if (container) {
					container.innerHTML = `<p style="margin: 0;"><strong>Email:</strong> <a href="mailto:${email}">${email}</a></p>`;
					container.classList.add('visible');
					this.style.display = 'none';
				}
			});
		</script>
	</body>
</html>
